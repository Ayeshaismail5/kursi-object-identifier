document.getElementById('imageInput').addEventListener('change', function (event) { const file = event.target.files[0]; if (!file) return; const img = new Image(); const canvas = document.getElementById('canvas'); const ctx = canvas.getContext('2d'); const resultDiv = document.getElementById('result'); const preview = document.getElementById('preview'); const reader = new FileReader(); reader.onload = function (e) { img.src = e.target.result; preview.innerHTML = `<img src="${e.target.result}" alt="Preview Image">`; }; img.onload = function () { canvas.width = 100; canvas.height = 100; ctx.drawImage(img, 0, 0, 100, 100); const imageData = ctx.getImageData(0, 0, 100, 100); const data = imageData.data;
let totalBrightness = 0; let colorCount = {}; let totalSaturation = 0; for (let i = 0; i < data.length; i += 4) { const r = data[i]; const g = data[i + 1]; const b = data[i + 2]; // Brightness const brightness = (r + g + b) / 3; totalBrightness += brightness; // RGB to HSL to get saturation const max = Math.max(r, g, b); const min = Math.min(r, g, b); const delta = max - min; const l = (max + min) / 2; let s = 0; if (delta !== 0) { s = delta / (255 - Math.abs(2 * l - 255)); } totalSaturation += s * 100; const key = `${r >> 4}-${g >> 4}-${b >> 4}`; colorCount[key] = (colorCount[key] || 0) + 1; } const numPixels = data.length / 4; const avgBrightness = totalBrightness / numPixels; const avgSaturation = totalSaturation / numPixels; const numColors = Object.keys(colorCount).length; let belt = ""; if (avgBrightness < 60 && numColors < 25) { belt = "A (Black)"; } else if (avgBrightness > 180 && avgSaturation < 15) { belt = "B (Transparent)"; } else if (numColors > 100) { belt = "C (Colorful)"; } else { belt = "Uncertain â€“ Needs Manual Check"; }
resultDiv.innerHTML = `Assigned to Conveyor Belt: <strong>${belt}</strong>`; }; reader.readAsDataURL(file); });
